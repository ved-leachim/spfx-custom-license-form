import { _BrowserUtilities } from '@microsoft/sp-core-library';
import { PromotedState } from './PromotedState';
import { PageType } from './PageType';
export function setPageExtraData(contextInfo, extraData // tslint:disable-line:no-any
) {
    if (!extraData) {
        extraData = {};
    }
    extraData.pageId = contextInfo.pageId;
    extraData.isHub = contextInfo.isHubSite;
    if (contextInfo.isHubSite) {
        extraData.hubSiteId = contextInfo.hubSiteId;
        extraData.isAssociatedSite = false;
    }
    else if (!contextInfo.isHubSite && contextInfo.hubSiteId) {
        // If isHubSite is false, but hubSiteId is set, we call it associatedSite
        extraData.isAssociatedSite = true;
    }
    else {
        extraData.isAssociatedSite = false;
    }
    if (_BrowserUtilities.isTeamsHosted()) {
        extraData.displayApp = "Teams" /* Teams */;
    }
    else {
        extraData.displayApp = "Sharepoint" /* Sharepoint */;
    }
    extraData.userAgent = navigator.userAgent;
    var webTemplate = contextInfo.webTemplate;
    extraData.webTemplate = webTemplate;
    var siteType;
    if (webTemplate === "1" /* TeamSite */) {
        siteType = 'TeamSite';
    }
    else if (webTemplate === "64" /* GroupSite */) {
        siteType = 'GroupSite';
    }
    else if (webTemplate === "68" /* SitePagePublishing */) {
        siteType = 'CommunicationSite';
    }
    var promotedState = contextInfo.promotedState;
    var pageLayoutType = contextInfo.pageType;
    var pageType = pageLayoutType;
    if (pageLayoutType === PageType.Article) {
        if (promotedState === PromotedState.NotPromoted || promotedState === undefined) {
            pageType = PageType.Article;
        }
        else {
            pageType = PageType.News;
        }
    }
    extraData.siteType = siteType;
    extraData.pageType = pageType;
}
//# sourceMappingURL=setPageExtraData.js.map