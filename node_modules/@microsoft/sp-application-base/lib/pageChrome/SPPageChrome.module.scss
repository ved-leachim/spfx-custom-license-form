// Copies of Fabric variables because there is no mechanism to reference Fabric variables at this time.
// @todo (SPPPLAT VSO#216209): Create a way to reference Fabric variables
$ms-animation-duration-3: 0.367s;
$ms-animation-ease-1: cubic-bezier(0.1, 0.9, 0.2, 1);
$suiteNavHeaderHeight: 50px;
// There is no way to import fabric here so we need to add these manually. Should be cleaned up with VSO#216209
$ms-color-themeDark: '[theme:themeDark, default: #005a9e]';
$ms-color-neutralLighter: '[theme:neutralLighter, default: #f4f4f4]';
$ms-font-mediumFontSize: '[theme:mediumFontSize, default: 14px]';
$ms-font-mediumFontWeight: '[theme:mediumFontWeight, default: 400]';
@mixin mediumFontBasic {
  font-size: $ms-font-mediumFontSize;
  font-weight: $ms-font-mediumFontWeight;
}
body {
  height: 100vh;
  margin: 0;
  padding: 0;
}

:global .SPPageChrome {
  display: flex;
  flex-direction: column;
  height: 100%;
}

:global #SuiteNavWrapper {
  background-color: rgb(51, 51, 51);
  width: 100%;
  z-index: 12;

  &:empty {
    display: none;
  }
}

// The css rule for :global .SPPageChrome-app > div affects the top div of every application without them knowing.
// This style rules make Fabric work and should apply to the div wrapping around the div with ms-Fabric class.
// We should come up with a better way to handle this so we don't affect all applications unexpectedly.
// VSO #380657 - Fix Fabric Styling for SpPageChrome
:global .SPPageChrome-app,
:global .SPPageChrome-app > div {
  flex-grow: 1;
  display: flex;
  max-width: 100%;
}

:global .SPPageChromeNoFlexbox-app {
  position: absolute;
  right: 0;
  bottom: 0;
  left: 0;
  overflow: visible;
}

:global .spAppAndPropertyPanelContainer {
  display: flex;
  flex-grow: 1;
  height: 100%;
  transition: padding-bottom 0.3s;
  .SPPageChrome-app {
    min-width: 0;
  }
  .spPropertyPaneContainer {
    flex-shrink: 0;
  }
  .sp-appBar {
    min-width: 47px;
    background: #f3f2f1;
    display: block;
    max-width: 47px;
  }
  .sp-appBar-mobile {
    min-width: 0;
    max-width: none;
  }
  .sp-appBar-callout {
    background: white;
    opacity: 1;
    transition: opacity 0.3s;
    box-shadow: 10px 5.4px 14.4px -10px rgba(0, 0, 0, 0.132), 10px 0.2px 3.6px -10px rgba(0, 0, 0, 0.108);
    left: 0;
    top: 0;
    width: 320px;
    height: 100vh;
    position: fixed;
    z-index: 10;
  }
  .sp-appBar-callout.fade {
    opacity: 0;
  }
  .callout-close {
    text-align: end;
    margin-top: 8px;
  }
  .callout-close-button {
    cursor: pointer;
    border: none;
    background: inherit;
    color: #666666;
    margin-right: 5px;
    font-size: larger;
  }
  .callout-iframe {
    width: 100%;
    height: calc(100vh - 84px);
    border: none;
  }
  .w90 {
    width: 90%;
  }
  .w80 {
    width: 80%;
  }
  .callout-close-button:hover {
    background: #e9e8e8;
  }
}

.spAppBarParentMobile {
  padding-bottom: 48px;
  overflow: hidden;
}

// PropertyPane container div
:global .spPropertyPaneContainer {
  width: 0;
  position: relative;
  z-index: 999; // This is for the classic page.
}

// PropertyPane container div
:global .spPropertyPaneContainerNoFlexbox {
  // Changing the position to 'fixed' because with all it's siblings absolutely poistioned,
  // when applying transitions on the elements browser is confused while calculating the width of page.
  // Due to this there were flickerings on the page.
  top: $suiteNavHeaderHeight;
  position: fixed;
  right: -340px;
  bottom: 0;
  z-index: 999; // This is for the classic page.
}

// PropertyPane and PageContent animation
.spPageContentTransition {
  transition: width $ms-animation-duration-3 $ms-animation-ease-1;
  -webkit-transition: width $ms-animation-duration-3 $ms-animation-ease-1;
}

:global #sp-skipToContent {
  @include mediumFontBasic;
  color: $ms-color-themeDark;
  background-color: $ms-color-neutralLighter;
}

:global {
  @media print {
    #sp-skipToContent,
    #RecommendedItems,
    .headerViewClass,
    .commandBarWrapper,
    div[data-sp-placeholder='Top'],
    div[data-sp-placeholder='Bottom'],
    div[data-sp-feature-tag='Site header host'],
    div[data-sp-feature-tag='Comments'],
    div[data-automationid='SimpleFooter'] {
      display: none;
    }
    #SuiteNavWrapper,
    .ms-HubNav {
      display: none !important;
    }
  }
}
