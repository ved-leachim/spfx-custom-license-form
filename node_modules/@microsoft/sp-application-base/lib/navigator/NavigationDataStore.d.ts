import { _IPreloadedData } from '@microsoft/sp-loader';
import { INavigationPropertiesWithPrefetch, INavigationProperties } from './INavigationResult';
import { INavigationDataResponse } from './INavigationDataResponse';
/**
 * Represents the contract of a navigation data store item
 *
 * @internal
 */
export interface INavigationDataStoreItem {
    /**
     * The navigation source url
     */
    url: string;
    /**
     * The last access time
     */
    accessedTime: number;
    /**
     * The fetched time stamp
     */
    fetchedTime: number;
    /**
     * The prefetched application data
     */
    prefetchedData: any | undefined;
    /**
     * The preloaded navigation data
     */
    preloadedData: _IPreloadedData | undefined;
    /**
     * A reference to the item
     */
    itemReference: string;
}
/**
 * Represents the contract of a Navigation data store heap
 *
 * @internal
 */
export interface INavigationDataStoreHeap<TItem extends INavigationDataStoreItem> {
    items: Array<TItem>;
    size: number;
}
/**
 * Represents the contract of a navigation data cache store
 *
 * @internal
 */
export interface INavigationDataStore<TItem extends INavigationDataStoreItem> {
    /**
     * Gets the store id
     */
    id: string;
    /**
     * Gets the store item collection
     */
    items: Array<TItem>;
    /**
     * Gets an item associated with a given key
     * @param url - The URL
     * @param props - Optional Navigation property bag
     *
     * @returns The Promise associated with the navigation data response.
     */
    getData(url: string, props?: INavigationProperties | INavigationPropertiesWithPrefetch): Promise<INavigationDataResponse>;
    /**
     * Removes an item associated with a given key
     * @param url - The URL or Regular expression
     */
    remove(url: string | RegExp): void;
}
/**
 * Navigation Data Store that stores navigation data items while enforcing
 * constraints to ensure optimal use of resources
 *
 * @internal
 */
export default class NavigationDataStore<TItem extends INavigationDataStoreItem> implements INavigationDataStore<TItem> {
    private static readonly refreshThresholdMs;
    private static readonly maxStoreSize;
    private _id;
    private _executor;
    private _dataValidator;
    private _store;
    private _refreshThreshold;
    private _maxStoreSize;
    private static _leftChild;
    private static _rightChild;
    private static _parent;
    private static _swap;
    private static _generateItemCacheKey;
    private static _fetchSessionCacheEntry;
    private static _fetchItemData;
    private static _upsertItemData;
    private static _removeItemEntries;
    private static _initStore;
    private static _updateStore;
    private static _generatePreloadHeaders;
    private static _generatePrefetchHeaders;
    private static _normalizeUrl;
    constructor(id: string, buildIdKey: string, buildId: string, executor: <T>(url: string, headers?: Headers) => Promise<T>, validator: (preloadedData: _IPreloadedData) => void, refreshThresholdMs?: number, maxStoreSize?: number);
    /**
     * Gets the Store Id
     */
    get id(): string;
    /**
     * Gets all the store items
     */
    get items(): Array<TItem>;
    /**
     * Gets the item associated with a key.
     *
     * @remarks
     * If the Item exists in the store and is still valid then returns from the store,
     * else relies on the executor to fetch the item from the store and upserts it accordingly
     *
     * @param url - The url corresponding to the item
     * @param props - Optional Navigation property bag
     *
     * @returns The Promise associated with the navigation data response.
     */
    getData(url: string, props?: INavigationProperties | INavigationPropertiesWithPrefetch): Promise<INavigationDataResponse>;
    /**
     * Removes an item associated with a given key or matching a key RegExp
     * @param url - The URL or RegExp
     */
    remove(url: string | RegExp): void;
    /**
     * Removes all items whose key matches this RegExp
     * @param regExp any keys matching this regex will be removed
     * @returns whether any items were removed
     */
    private _removeMatching;
    private _addOrUpdateCacheEntry;
    private _fetchData;
    private _heapify;
    private _extractMin;
    private _reduceKey;
    private _insert;
    private _buildMinHeap;
    private _findItem;
}
//# sourceMappingURL=NavigationDataStore.d.ts.map