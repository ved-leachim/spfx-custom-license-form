/**
 * @Copyright (c) Microsoft Corporation.  All rights reserved.
 *
 * @file TraceList.tsx
 *
 * Sub-component for TraceDisplay. This component displays the log
 * events from the trace in table form.
 * It will show the name and the level, message, scope, source.
 */
import { __extends } from "tslib";
import * as React from 'react';
import { LogLevel } from '../../../../Stores/TraceDisplayStore';
import TraceListHeader from './TraceListHeader/TraceListHeader';
import TraceListItem from './TraceListItem/TraceListItem';
import { triggerCsvDownload } from './CsvRenderer';
import styles from './TraceList.module.scss';
import * as strings from './../TraceDisplay.resx';
var TraceList = /** @class */ (function (_super) {
    __extends(TraceList, _super);
    function TraceList() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this._handleButtonClick = function () {
            triggerCsvDownload(_this.props.allTraces);
        };
        return _this;
    }
    TraceList.prototype.render = function () {
        var _this = this;
        var idCounter = 0;
        var displayedTraces = [];
        var levelFilters = this.props.filters.level;
        var scopeFilters = this.props.filters.scope;
        var sourceFilters = this.props.filters.source;
        if (!this.props.allTraces) {
            return (React.createElement("div", null,
                React.createElement(TraceListHeader, { filters: this.props.filters }),
                strings.EmptyTraceData));
        }
        this.props.allTraces.forEach(function (trace) {
            if (levelFilters[LogLevel[trace.level]] === false) {
                return;
            }
            if (trace.scope) {
                _this._addFilterLabel(trace.scope.id, scopeFilters);
                if (!scopeFilters[trace.scope.id]) {
                    return;
                }
            }
            else if (scopeFilters.none === false) {
                return;
            }
            if (trace.source) {
                _this._addFilterLabel(trace.source, sourceFilters);
                if (!sourceFilters[trace.source]) {
                    return;
                }
            }
            displayedTraces.push(React.createElement(TraceListItem, { key: idCounter, id: idCounter, trace: trace }));
            idCounter++;
        });
        return (React.createElement("div", { className: styles.container },
            React.createElement("button", { onClick: this._handleButtonClick }, strings.ExportCSVButtonLabel),
            React.createElement(TraceListHeader, { filters: this.props.filters }),
            React.createElement("ul", { className: styles.traceListItemsContainer }, displayedTraces)));
    };
    TraceList.prototype._addFilterLabel = function (filterLabel, multiFilter) {
        if (filterLabel && !(filterLabel in multiFilter)) {
            multiFilter[filterLabel] = true;
        }
    };
    return TraceList;
}(React.Component));
export default TraceList;
//# sourceMappingURL=TraceList.js.map